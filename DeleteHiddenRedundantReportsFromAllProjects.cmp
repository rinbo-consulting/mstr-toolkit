<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<PROCEDURE_DEFINITION>
<DESCRIPTION/>
<CODE>ResultSet projects = executeCapture("LIST ALL PROJECTS;");&#13;
&#13;
projects.moveFirst();&#13;
while(!projects.isEof()) {&#13;
&#13;
String projectName = projects.getResultCell(NAME).getValueString();&#13;
&#13;
printOut("Scanning " + projectName);&#13;
&#13;
ResultSet reports = executeCapture("LIST ALL REPORTS FOR PROJECT \""+projectName+"\";");&#13;
&#13;
int totalReports = reports.getRowCount();&#13;
&#13;
int reportCounter = 0;&#13;
int hiddenCounter = 0;&#13;
int deletedCounter = 0;&#13;
&#13;
reports.moveFirst();&#13;
&#13;
while (!reports.isEof()) {&#13;
    reportCounter++;&#13;
    Boolean isHidden = (Boolean)reports.getResultCell(HIDDEN).getValue();&#13;
    String folder = reports.getResultCell(FOLDER).getValueString();&#13;
    String name = reports.getResultCell(NAME).getValueString();&#13;
    printOut("Scanning report " + reportCounter + " of " + totalReports);&#13;
    if (isHidden) {&#13;
        hiddenCounter++;&#13;
        printOut ("Well, " + name + " is hidden...");&#13;
        ResultSet dependents = executeCapture("LIST ALL DEPENDENTS FOR REPORT \""+name+"\" IN FOLDER \""+folder+"\" IN PROJECT \""+projectName+"\";");&#13;
        if (dependents.getRowCount() == 0) {&#13;
            deletedCounter++;&#13;
            execute("DELETE REPORT \""+name+"\" IN FOLDER \""+folder+"\" FROM PROJECT \""+projectName+"\";");&#13;
            printOut("...and it has no dependents. Gone.");&#13;
        } else {&#13;
        printOut("...but something's using it, so it lives.");&#13;
        }&#13;
    }&#13;
    reports.moveNext();&#13;
}&#13;
printOut("Reports scanned: " + reportCounter);&#13;
printOut("Reports hidden: " + hiddenCounter);&#13;
printOut("Reports deleted: " + deletedCounter);&#13;
&#13;
projects.moveNext();&#13;
}</CODE>
<SAMPLE/>
<VERSION>1.0</VERSION>
<TYPE>CUSTOM</TYPE>
<INPUT_PARAMS/>
<CLASSPATH/>
<TEST_INPUT/>
<TEST_CONNECTION_INFO>
<TEST_PSN_NAME/>
<TEST_USERNAME/>
<TEST_PASSWORD>00000000453ec11a5ae5e97cb1fe638b94860d28c911585ab4fc4c77d5b77ded</TEST_PASSWORD>
</TEST_CONNECTION_INFO>
</PROCEDURE_DEFINITION>
