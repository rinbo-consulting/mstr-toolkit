<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<PROCEDURE_DEFINITION>
<DESCRIPTION/>
<CODE>ResultSet reports = executeCapture("LIST ALL REPORTS FOR PROJECT \""+projectName+"\";");&#13;
&#13;
int totalReports = reports.getRowCount();&#13;
&#13;
int reportCounter = 0;&#13;
int hiddenCounter = 0;&#13;
int deletedCounter = 0;&#13;
&#13;
reports.moveFirst();&#13;
&#13;
while (!reports.isEof()) {&#13;
    reportCounter++;&#13;
    Boolean isHidden = (Boolean)reports.getResultCell(HIDDEN).getValue();&#13;
    String folder = reports.getResultCell(FOLDER).getValueString();&#13;
    String name = reports.getResultCell(NAME).getValueString();&#13;
    printOut("Scanning report " + reportCounter + " of " + totalReports);&#13;
    if (isHidden) {&#13;
        hiddenCounter++;&#13;
        printOut ("Well, " + name + " is hidden...");&#13;
        ResultSet dependents = executeCapture("LIST ALL DEPENDENTS FOR REPORT \""+name+"\" IN FOLDER \""+folder+"\" IN PROJECT \""+projectName+"\";");&#13;
        if (dependents.getRowCount() == 0) {&#13;
            deletedCounter++;&#13;
            printOut("...and it has no dependents. Gone.");&#13;
            execute("DELETE REPORT \""+name+"\" IN FOLDER \""+folder+"\" FROM PROJECT \""+projectName+"\";");&#13;
        } else {&#13;
        printOut("...but something's using it, so it lives.");&#13;
        }&#13;
    }&#13;
    reports.moveNext();&#13;
}&#13;
printOut("Reports scanned: " + reportCounter);&#13;
printOut("Reports hidden: " + hiddenCounter);&#13;
printOut("Reports deleted: " + deletedCounter);</CODE>
<SAMPLE>EXECUTE PROCEDURE DeleteHiddenRedundantReports("Your project name here");</SAMPLE>
<VERSION>1.0</VERSION>
<TYPE>CUSTOM</TYPE>
<INPUT_PARAMS>
<INPUT INPUT_TYPE="STRING">projectName</INPUT>
</INPUT_PARAMS>
<CLASSPATH/>
<TEST_INPUT>
<TEST_INPUT_PARAM>Test Project Name</TEST_INPUT_PARAM>
</TEST_INPUT>
<TEST_CONNECTION_INFO>
<TEST_PSN_NAME>Test Project Source</TEST_PSN_NAME>
<TEST_USERNAME>testusers</TEST_USERNAME>
<TEST_PASSWORD></TEST_PASSWORD>
</TEST_CONNECTION_INFO>
</PROCEDURE_DEFINITION>
